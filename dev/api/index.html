<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API reference · ReducedBasis.jl</title><meta name="title" content="API reference · ReducedBasis.jl"/><meta property="og:title" content="API reference · ReducedBasis.jl"/><meta property="twitter:title" content="API reference · ReducedBasis.jl"/><meta name="description" content="Documentation for ReducedBasis.jl."/><meta property="og:description" content="Documentation for ReducedBasis.jl."/><meta property="twitter:description" content="Documentation for ReducedBasis.jl."/><meta property="og:url" content="https://mfherbst.github.io/ReducedBasis.jl/api/"/><meta property="twitter:url" content="https://mfherbst.github.io/ReducedBasis.jl/api/"/><link rel="canonical" href="https://mfherbst.github.io/ReducedBasis.jl/api/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ReducedBasis.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/xxz_ed/">The reduced basis workflow</a></li><li><a class="tocitem" href="../examples/xxz_dmrg/">Greedy basis assembly using DMRG</a></li><li><a class="tocitem" href="../examples/xxz_pod/">Basis assembly using Proper Orthogonal Decomposition</a></li><li><a class="tocitem" href="../examples/multi_ad/">Affine decompositions with multi-indices and additional parameters</a></li><li><a class="tocitem" href="../examples/basis_analysis/">Analyzing and modifying a reduced basis after assembly</a></li></ul></li><li class="is-active"><a class="tocitem" href>API reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/mfherbst/ReducedBasis.jl/blob/master/docs/src/api.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API-reference"><a class="docs-heading-anchor" href="#API-reference">API reference</a><a id="API-reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-reference" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.AffineDecomposition" href="#ReducedBasis.AffineDecomposition"><code>ReducedBasis.AffineDecomposition</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Represents an affine decomposition</p><p class="math-container">\[O(\bm{\mu}) = \sum_{r=1}^R \alpha_r(\bm{\mu})\, O_r\]</p><p>where <code>terms&lt;:AbstractArray</code> carries the <span>$O_r$</span> matrices (or more generally linear maps) and the <code>coefficients</code> implements the <span>$\alpha_r(\bm{\mu})$</span> coefficient functions.</p><p>In the case where the <span>$\alpha_r$</span> are constant coefficients, i.e. that don&#39;t depend on the parameter vector, <code>coefficients</code> can also just be an <code>AbstractArray</code> of the same size as <code>terms</code>.</p><p>Note that <span>$r = (r_1, \dots, r_d)$</span> generally is a multi-index and as such <code>terms</code> can be a <span>$d$</span>-dimensional array. Correspondingly, <code>coefficients</code> maps parameter points <span>$\bm{\mu}$</span> to an <code>size(terms)</code> array.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/affine_decomposition.jl#L1-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.AffineDecomposition-Tuple{Any}" href="#ReducedBasis.AffineDecomposition-Tuple{Any}"><code>ReducedBasis.AffineDecomposition</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">(ad::AffineDecomposition{&lt;:AbstractArray{&lt;:ApproxMPO}})(μ)</code></pre><p>Compute sum with <code>ApproxMPO</code>s using the exact <code>ITensors</code> operator sum.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/mps.jl#L82-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.ApproxMPO" href="#ReducedBasis.ApproxMPO"><code>ReducedBasis.ApproxMPO</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Carries an <code>ITensors.MPO</code> matrix-product operator and possible truncation keyword arguments.</p><p>This enables a simple <code>mpo * mps</code> syntax while allowing for proper truncation throughout the basis assembly. Includes the exact operator sum in <code>opsum</code> to be able to produce efficient sums of MPOs when constructing <a href="#ReducedBasis.AffineDecomposition"><code>AffineDecomposition</code></a> sums explicitly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/mps.jl#L32-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.ApproxMPO-Tuple{ITensors.ITensorMPS.MPO, Any}" href="#ReducedBasis.ApproxMPO-Tuple{ITensors.ITensorMPS.MPO, Any}"><code>ReducedBasis.ApproxMPO</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ApproxMPO(mpo::MPO, opsum; &lt;keyword arguments&gt;)</code></pre><p>Construct an <code>ApproxMPO</code> with default truncation settings.</p><p><strong>Arguments</strong></p><ul><li><code>mpo::MPO</code></li><li><code>opsum::Sum{Scaled{ComplexF64,Prod{Op}}}</code></li><li><code>cutoff::Float64=1e-9</code>: relative cutoff for singular values.</li><li><code>maxdim::Int=1000</code>: maximal bond dimension.</li><li><code>mindim::Int=1</code>: minimal bond dimension.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/mps.jl#L48-L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.DMRG" href="#ReducedBasis.DMRG"><code>ReducedBasis.DMRG</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Solver type for the density matrix renormalization group (DMRG) as implemented in <a href="https://itensor.github.io/ITensors.jl/stable/DMRG.html"><code>ITensors.dmrg</code></a>.</p><p><strong>Fields</strong></p><ul><li><code>n_states::Int=1</code>: see <a href="#ReducedBasis.FullDiagonalization"><code>FullDiagonalization</code></a>.</li><li><code>tol_degeneracy::Float64=0.0</code>: see <a href="#ReducedBasis.FullDiagonalization"><code>FullDiagonalization</code></a>.</li><li><code>sweeps::Sweeps=default_sweeps(; cutoff_max=1e-9, bonddim_max=1000)</code>: set DMRG sweep settings via <code>ITensors.Sweeps</code>.</li><li><code>observer::Function=() -&gt; DMRGObserver(; energy_tol=1e-9)</code>: set DMRG exit conditions. At each solve a new <code>ITensors.AbstractObserver</code> object is created.</li><li><code>verbose::Bool=false</code>: if <code>true</code>, prints info about DMRG solve.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/mps.jl#L93-L106">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.EigenDecomposition" href="#ReducedBasis.EigenDecomposition"><code>ReducedBasis.EigenDecomposition</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Extension type for orthogonalization and compression using eigenvalue decomposition of the basis overlap matrix. See also <a href="#ReducedBasis.extend-Tuple{RBasis, AbstractVector, Any, EigenDecomposition}"><code>extend</code></a>.</p><p><strong>Fields</strong></p><ul><li><code>cutoff::Float64=1e-6</code>: cutoff for minimal eigenvalue accuracy.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/rbasis.jl#L125-L132">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.ErrorEstimate" href="#ReducedBasis.ErrorEstimate"><code>ReducedBasis.ErrorEstimate</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Super type of all error estimators.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/greedy.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.FullDiagonalization" href="#ReducedBasis.FullDiagonalization"><code>ReducedBasis.FullDiagonalization</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Solver type for full diagonalization using <a href="https://docs.julialang.org/en/v1/stdlib/LinearAlgebra/#LinearAlgebra.eigen"><code>LinearAlgebra.eigen</code></a>.</p><p><strong>Fields</strong></p><ul><li><code>n_target::Int=1</code>: the number of the targeted eigenvalue. If <code>n_target=1</code>, the degeneracy of the ground state is automatically determined up to <code>tol_degeneracy</code>. If <code>tol_degeneracy=0</code>, it determines the number of returned vectors per solve (also includes excited states).</li><li><code>tol_degeneracy::Float64=0.0</code>: tolerance for distinguishing two eigenvalues. If <code>abs(λ₁ - λ₂) &lt; tol_degeneracy</code>, the eigenvalues are added to the same degenerate subspace.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/full_diag.jl#L1-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.FullDiagonalization-Tuple{DMRG}" href="#ReducedBasis.FullDiagonalization-Tuple{DMRG}"><code>ReducedBasis.FullDiagonalization</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">FullDiagonalization(dm::DMRG)</code></pre><p>Construct <a href="#ReducedBasis.FullDiagonalization"><code>FullDiagonalization</code></a> with the same degeneracy tolerance as <code>dm</code> and fix <code>n_target=1</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/mps.jl#L115-L120">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.FullDiagonalization-Tuple{LOBPCG}" href="#ReducedBasis.FullDiagonalization-Tuple{LOBPCG}"><code>ReducedBasis.FullDiagonalization</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">FullDiagonalization(lobpcg::LOBPCG)</code></pre><p>Construct the <a href="#ReducedBasis.FullDiagonalization"><code>FullDiagonalization</code></a> solver with degeneracy settings matching <code>lobpcg</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/lobpcg.jl#L56-L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.Greedy" href="#ReducedBasis.Greedy"><code>ReducedBasis.Greedy</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Greedy reduced basis assembling strategy.</p><p><strong>Fields</strong></p><ul><li><code>estimator::ErrorEstimate</code>: error estimate used in greedy condition. See also <a href="#ReducedBasis.estimate_error-Tuple{Residual, Any, HamiltonianCache, RBasis, Any}"><code>estimate_error</code></a></li><li><code>tol::Float64=1e-3</code>: tolerance for error estimate, below which the assembly is terminated.</li><li><code>n_truth_max::Int=64</code>: maximal number of truth solves to be taken up in the basis.</li><li><code>Ψ_init::Function=rb_guess</code>: returns initial guess for truth solver. See also <a href="#ReducedBasis.interpolate-Tuple{RBasis, AffineDecomposition, Any, Any}"><code>interpolate</code></a>.</li><li><code>verbose::Bool=true</code>: print information during assembly if <code>true</code>.</li><li><code>exit_checks::Bool=true</code>: if <code>false</code>, no exit checks will be performed and the assembly will run until <code>tol</code> or <code>n_truth_max</code> are reached.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/greedy.jl#L25-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.HamiltonianCache" href="#ReducedBasis.HamiltonianCache"><code>ReducedBasis.HamiltonianCache</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Convenience type storing a Hamiltonian, its applications to vectors and its compressions.</p><p><strong>Fields</strong></p><ul><li><code>H::AffineDecomposition</code></li><li><code>HΨ::Vector{V}</code></li><li><code>ΨHΨ::Vector{Matrix{T}}</code></li><li><code>ΨHHΨ::Matrix{Matrix{T}}</code></li><li><code>h::AffineDecomposition</code></li><li><code>h²::AffineDecomposition</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/hamiltonian_cache.jl#L1-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.HamiltonianCache-Tuple{AffineDecomposition, RBasis}" href="#ReducedBasis.HamiltonianCache-Tuple{AffineDecomposition, RBasis}"><code>ReducedBasis.HamiltonianCache</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">HamiltonianCache(H::AffineDecomposition, basis::RBasis)</code></pre><p>Construct <a href="#ReducedBasis.HamiltonianCache"><code>HamiltonianCache</code></a> from a Hamiltonian computing all applications and compressions with an reduced basis.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/hamiltonian_cache.jl#L22-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.HamiltonianCache-Union{Tuple{T}, Tuple{V}, Tuple{HamiltonianCache, RBasis{V, T}}} where {V, T}" href="#ReducedBasis.HamiltonianCache-Union{Tuple{T}, Tuple{V}, Tuple{HamiltonianCache, RBasis{V, T}}} where {V, T}"><code>ReducedBasis.HamiltonianCache</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">HamiltonianCache(hc::HamiltonianCache, basis::RBasis{V,T}) where {V,T}</code></pre><p>Construct from previous <a href="#ReducedBasis.HamiltonianCache"><code>HamiltonianCache</code></a>, only computing necessary Hamiltonian applications and inner products.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/hamiltonian_cache.jl#L40-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.InfoCollector" href="#ReducedBasis.InfoCollector"><code>ReducedBasis.InfoCollector</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Carries a <code>Dict</code> of <code>Vector</code>s which contain information from greedy assembly iterations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/callback.jl#L28-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.InfoCollector-Tuple{Any}" href="#ReducedBasis.InfoCollector-Tuple{Any}"><code>ReducedBasis.InfoCollector</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">(collector::InfoCollector)(info)</code></pre><p>Push iteration information into <code>InfoCollector</code> and return <code>info</code> object, containing the <code>InfoCollector</code> itself.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/callback.jl#L57-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.InfoCollector-Tuple{Vararg{Symbol}}" href="#ReducedBasis.InfoCollector-Tuple{Vararg{Symbol}}"><code>ReducedBasis.InfoCollector</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">InfoCollector(fields::Symbol...)</code></pre><p>Construct <code>InfoCollector</code> from fields that are contained in the <code>info</code> iteration state object. Possible fields to select from are:</p><ul><li><code>iteration</code>: number of iteration at which the information was obtained.</li><li><code>err_grid</code>: error estimate on all parameter points of the training grid.</li><li><code>λ_grid</code>: RB energies on all training grid points.</li><li><code>err_max</code>: maximal error estimate on the grid.</li><li><code>μ</code>: parameter point at which truth solve has been performed.</li><li><code>solver_info</code>: output of the solving method, which excludes eigenvalues and vectors.</li><li><code>basis</code>: <code>RBasis</code> at the current iteration.</li><li><code>extend_info</code>: info that is specific to the chosen extension procedure, not including</li></ul><p>the extended <code>RBasis</code>.</p><ul><li><code>condnum</code>: condition number of the <span>$B^\dagger B$</span>.</li><li><code>h</code>: current reduced Hamiltonian.</li><li><code>h_cache</code>: <code>HamiltonianCache</code> at the current iteration.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/callback.jl#L34-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.LOBPCG" href="#ReducedBasis.LOBPCG"><code>ReducedBasis.LOBPCG</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Solver type for the Locally Optimal Block Preconditioned Conjugate Gradient (LOBPCG). Currently uses the DFTK <a href="https://github.com/JuliaMolSim/DFTK.jl/blob/master/src/eigen/diag_lobpcg_hyper.jl"><code>lobpcg_hyper</code></a> implementation.</p><p><strong>Fields</strong></p><ul><li><code>n_target::Int=1</code>: see <a href="#ReducedBasis.FullDiagonalization"><code>FullDiagonalization</code></a>.</li><li><code>tol_degeneracy::Float64=0.0</code>: see <a href="#ReducedBasis.FullDiagonalization"><code>FullDiagonalization</code></a>.</li><li><code>tol::Float64=1e-9</code>: tolerance for residual norms.</li><li><code>maxiter::Int=300</code>: maximal number of LOBPCG iterations.</li><li><code>n_ep_extra::Int=4</code>: number of extra eigenpairs that are kept to improve convergence.</li><li><code>shift::Float64=-100</code>: eigenvalue shift.</li><li><code>verbose::Bool=false</code>: if <code>true</code>, print convergence messages.</li><li><code>dense_fallback::Bool=true</code>: if <code>false</code>, also non-converged states will be accepted. Otherwise <code>LinearAlgebra.eigen</code> is used for non-converged iterations.</li><li><code>maxdiagonal::Int=400</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/lobpcg.jl#L27-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.NoCompress" href="#ReducedBasis.NoCompress"><code>ReducedBasis.NoCompress</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Extension type for no orthonormalization or compression. See also <a href="#ReducedBasis.extend-Tuple{RBasis, AbstractVector, Any, EigenDecomposition}"><code>extend</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/rbasis.jl#L111">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.POD" href="#ReducedBasis.POD"><code>ReducedBasis.POD</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Proper orthogonal decomposition assembly strategy.</p><p><strong>Fields</strong></p><ul><li><code>n_vectors::Int</code>: number of retained singular vectors of the snapshot matrix in the returned basis.</li><li><code>verbose::Bool=true</code>: shows the truth solve progress if <code>true</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/pod.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.QRCompress" href="#ReducedBasis.QRCompress"><code>ReducedBasis.QRCompress</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Extension type for QR orthonormalization and compression. See <a href="#ReducedBasis.extend-Tuple{RBasis, AbstractVector, Any, EigenDecomposition}"><code>extend</code></a> for details.</p><p><strong>Fields</strong></p><ul><li><code>tol::Float64</code>: tolerance for compressing insignificant basis snapshots.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/rbasis.jl#L114-L120">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.RBasis" href="#ReducedBasis.RBasis"><code>ReducedBasis.RBasis</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Central type containing snapshots and associated objects that make a reduced basis.</p><p>The snapshot vectors are contained in <code>snapshots::AbstractVector{V}</code> where the snapshots are of type <code>V</code>. Here a &quot;snapshot&quot; refers to all vectors that were obtained from a solve at a specific parameter point. For greedy-generated bases, each element in <code>snapshots</code> has a parameter point in <code>parameter::Vector{P}</code>, i.e. for snapshots <span>$\bm{\Psi}(\bm{\mu_i}) = (\Psi_1(\bm{\mu_i}),\dots,\Psi_m(\bm{\mu_i}))$</span> of multiplicity <span>$m$</span> the parameter point <span>$\bm{\mu}$</span> is contained <span>$m$</span> times. However, for general basis-assembly strategies this one-to-one correspondence might not be true, e.g. for <a href="#ReducedBasis.POD"><code>POD</code></a> where <code>snapshots</code> contains singular vectors based on all truth solves.</p><p>Treated as a matrix, the reduced basis <span>$B = \Upsilon V$</span> is made up of the snapshot vectors as column vectors in <span>$\Upsilon$</span> and vector coefficients <span>$V$</span>. The latter are stored in <code>vectors</code>. In the simple case of <span>$B = \Upsilon$</span>, one sets <code>vectors=I</code>.</p><p>Since the matrix <span>$B^\dagger B = V^\dagger \Upsilon^\dagger \Upsilon V$</span> is frequently needed, both the <code>snapshot_overlaps</code> <span>$\Upsilon^\dagger \Upsilon$</span> and the <code>metric</code> <span>$B^\dagger B$</span> are stored with generic floating-point type <code>T</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/rbasis.jl#L3-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.RegularGrid" href="#ReducedBasis.RegularGrid"><code>ReducedBasis.RegularGrid</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Stores equidistant grid of parameter points as well as its interval ranges.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/grid.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.RegularGrid-Tuple{Vararg{StepRangeLen}}" href="#ReducedBasis.RegularGrid-Tuple{Vararg{StepRangeLen}}"><code>ReducedBasis.RegularGrid</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">RegularGrid(ranges::StepRangeLen...)</code></pre><p>Construct a <span>$D$</span>-dimensional <a href="#ReducedBasis.RegularGrid"><code>RegularGrid</code></a> from <span>$D$</span> ranges.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/grid.jl#L9-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.Residual" href="#ReducedBasis.Residual"><code>ReducedBasis.Residual</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Estimator type for the residual <span>$\mathrm{Res}(\bm{\mu}) = \lVert H(\bm{\mu}) B \varphi(\bm{\mu}) - \lambda B \varphi(\bm{\mu}) \rVert$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/greedy.jl#L6-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:*-Tuple{ApproxMPO, ITensors.ITensorMPS.MPS}" href="#Base.:*-Tuple{ApproxMPO, ITensors.ITensorMPS.MPS}"><code>Base.:*</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">*(o::ApproxMPO, mps::MPS)</code></pre><p>Apply <code>o.mpo</code> to <code>mps</code> using the truncation arguments contained in <code>o</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/mps.jl#L65-L69">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.truncate-Tuple{AffineDecomposition, RBasis}" href="#Base.truncate-Tuple{AffineDecomposition, RBasis}"><code>Base.truncate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Base.truncate(ad_raw::AffineDecomposition, basis_trunc::RBasis)
Base.truncate(ad::AffineDecomposition,
              basis_trunc::RBasis{V,T,P,&lt;:UniformScaling}) where {V,T&lt;:Number,P}</code></pre><p>Truncate an <a href="#ReducedBasis.AffineDecomposition"><code>AffineDecomposition</code></a>.</p><p>For general <a href="#ReducedBasis.RBasis"><code>RBasis</code></a>, the &quot;raw&quot; <a href="#ReducedBasis.AffineDecomposition"><code>AffineDecomposition</code></a> has to be provided, where <code>ad_raw.terms</code> are the matrix elements <span>$\Psi_i^\dagger O_r \Psi_j$</span>. The returned decomposition then contains the fully compressed transformed terms, i.e. <span>$B^\dagger O_r B$</span> using the truncated basis.</p><p>In case a basis is provided that has trivial <code>vectors=I</code>, the truncation is performed naively on the fully compressed terms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/truncate.jl#L65-L79">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.truncate-Tuple{HamiltonianCache, RBasis}" href="#Base.truncate-Tuple{HamiltonianCache, RBasis}"><code>Base.truncate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Base.truncate(hc::HamiltonianCache, basis_trunc::RBasis)</code></pre><p>Truncate a [<code>HamiltonianCache</code>] according to an already truncated basis.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/truncate.jl#L37-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.truncate-Tuple{RBasis, Int64}" href="#Base.truncate-Tuple{RBasis, Int64}"><code>Base.truncate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Base.truncate(basis::RBasis, n_truth::Int)</code></pre><p>Truncate the <a href="#ReducedBasis.RBasis"><code>RBasis</code></a> to <code>n_truth</code> snapshots.</p><p>Note that <code>n_truth</code> does not amount to the dimension of the truncated basis, but the number of truth solves included in the basis, which can feature degenerate snapshots.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/truncate.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.assemble-Tuple{AffineDecomposition, Any, POD, Any}" href="#ReducedBasis.assemble-Tuple{AffineDecomposition, Any, POD, Any}"><code>ReducedBasis.assemble</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">assemble(H::AffineDecomposition, grid, pod::POD, solver_truth)</code></pre><p>Assemble basis using <a href="#ReducedBasis.POD"><code>POD</code></a>.</p><p>Only ED solvers such as <a href="#ReducedBasis.FullDiagonalization"><code>FullDiagonalization</code></a> and <a href="#ReducedBasis.LOBPCG"><code>LOBPCG</code></a> are supported. The generated <a href="#ReducedBasis.RBasis"><code>RBasis</code></a> will contain <code>pod.n_vectors</code> singular vectors in <code>snapshots</code> and all grid points in <code>parameters</code>. This means that <code>parameters</code> and <code>snapshots</code> generally have different lengths.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/pod.jl#L15-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.assemble-Tuple{NamedTuple, AffineDecomposition, Any, Greedy, Any, Any}" href="#ReducedBasis.assemble-Tuple{NamedTuple, AffineDecomposition, Any, Greedy, Any, Any}"><code>ReducedBasis.assemble</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">assemble(H, grid, greedy, solver_truth, compressalg; &lt;keyword arguments&gt;)
assemble(info, H, grid, greedy, solver_truth, compressalg; &lt;keyword arguments&gt;)</code></pre><p>Assemble an <code>RBasis</code> using the greedy strategy and any truth solving method.</p><p>If <code>info</code> is not provided, start a greedy assembly from scratch.</p><p><strong>Arguments</strong></p><ul><li><code>info::NamedTuple</code>: iteration state from a previous simulation that will be resumed.</li><li><code>H::AffineDecomposition</code>: Hamiltonian for which a reduced basis is assembled.</li><li><code>grid</code>: parameter grid that defines the parameter domain.</li><li><code>greedy::Greedy</code>: greedy strategy containing assembly parameters. See also <a href="#ReducedBasis.Greedy"><code>Greedy</code></a>.</li><li><code>solver_truth</code>: solving method for obtaining ground state snapshots.</li><li><code>compressalg</code>: compression method for orthogonalization, etc. See also <a href="#ReducedBasis.extend-Tuple{RBasis, AbstractVector, Any, EigenDecomposition}"><code>extend</code></a>.</li><li><code>solver_online=FullDiagonalization(solver_truth)</code>: solving method that is used for the RB generalized eigenvalue problem.</li><li><code>callback=print_callback</code>: callback function that operates on the iteration state during assembly. It is possible to chain multiple callback functions using <code>∘</code>.</li><li><code>μ_start=grid[1]</code>: parameter point of the starting iteration, if no <code>info</code> is provided.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/greedy.jl#L85-L107">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.bounds-Union{Tuple{RegularGrid{D}}, Tuple{D}} where D" href="#ReducedBasis.bounds-Union{Tuple{RegularGrid{D}}, Tuple{D}} where D"><code>ReducedBasis.bounds</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">bounds(grid::RegularGrid{D}) where {D}</code></pre><p>Return <code>SVector</code> of grid boundaries.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/grid.jl#L33-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.compress-Tuple{AbstractMatrix, AbstractVector{&lt;:AbstractVector}}" href="#ReducedBasis.compress-Tuple{AbstractMatrix, AbstractVector{&lt;:AbstractVector}}"><code>ReducedBasis.compress</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compress(M::AbstractMatrix, snapshots::AbstractVector{&lt;:AbstractVector})</code></pre><p>Compress term using matrix multiplications.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/affine_decomposition.jl#L105-L109">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.compress-Tuple{AffineDecomposition, RBasis}" href="#ReducedBasis.compress-Tuple{AffineDecomposition, RBasis}"><code>ReducedBasis.compress</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compress(ad::AffineDecomposition, basis::RBasis)</code></pre><p>Perform the compression of an <a href="#ReducedBasis.AffineDecomposition"><code>AffineDecomposition</code></a> corresponding to <span>$o = B^\dagger O B$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/affine_decomposition.jl#L53-L58">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.compress-Tuple{AffineDecomposition{&lt;:Matrix}, RBasis}" href="#ReducedBasis.compress-Tuple{AffineDecomposition{&lt;:Matrix}, RBasis}"><code>ReducedBasis.compress</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compress(ad::AffineDecomposition{&lt;:Matrix,&lt;:Function},
         basis::RBasis; symmetric_terms=false)</code></pre><p>Perform compression for an <a href="#ReducedBasis.AffineDecomposition"><code>AffineDecomposition</code></a> with terms with two indices (double-sum observables), including an option to exploit the possible symmetry of terms <span>$O_{r,r&#39;} = O_{r&#39;,r}$</span>, such that only the necessary compressions are computed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/affine_decomposition.jl#L66-L74">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.compress-Tuple{Any, AbstractVector}" href="#ReducedBasis.compress-Tuple{Any, AbstractVector}"><code>ReducedBasis.compress</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compress(op, snapshots::AbstractVector)</code></pre><p>Compress one term of an <a href="#ReducedBasis.AffineDecomposition"><code>AffineDecomposition</code></a> <code>ApproxMPO</code> type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/affine_decomposition.jl#L96-L100">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.default_sweeps-Tuple{}" href="#ReducedBasis.default_sweeps-Tuple{}"><code>ReducedBasis.default_sweeps</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">default_sweeps(; cutoff_max=1e-9, bonddim_max=1000, iter_max=100)</code></pre><p>Return default <code>ITensors.Sweeps</code> object for DMRG solves, containing decreasing noise and increasing maximal bond dimension ramps.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/mps.jl#L126-L131">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.dimension-Tuple{RBasis}" href="#ReducedBasis.dimension-Tuple{RBasis}"><code>ReducedBasis.dimension</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">dimension(basis::RBasis)</code></pre><p>Return the basis dimension <span>$\dim B$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/rbasis.jl#L32-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.estimate_error-Tuple{Residual, Any, HamiltonianCache, RBasis, Any}" href="#ReducedBasis.estimate_error-Tuple{Residual, Any, HamiltonianCache, RBasis, Any}"><code>ReducedBasis.estimate_error</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">estimate_error(::Residual, μ, h_cache::HamiltonianCache, basis::RBasis, sol_rb)</code></pre><p>Estimate error of reduced basis using the <a href="#ReducedBasis.Residual"><code>Residual</code></a> estimator.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/greedy.jl#L12-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.extend-Tuple{RBasis, AbstractVector, Any, EigenDecomposition}" href="#ReducedBasis.extend-Tuple{RBasis, AbstractVector, Any, EigenDecomposition}"><code>ReducedBasis.extend</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">extend(basis::RBasis, new_snapshot::AbstractVector, μ, ed::EigenDecomposition)</code></pre><p>Extend the reduced basis by orthonormalizing and compressing via eigenvalue decomposition.</p><p>The overlap matrix <span>$S$</span> in <code>basis.snapshot_overlaps</code> is eigenvalue decomposed <span>$S = U^\dagger \Lambda U$</span> and orthonormalized by computing the vector coefficients <span>$V = U \Lambda^{-1/2}$</span>. Modes with an relative squared eigenvalue error smaller than <code>ed.cutoff</code> are dropped.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/rbasis.jl#L183-L192">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.extend-Tuple{RBasis, AbstractVector, Any, NoCompress}" href="#ReducedBasis.extend-Tuple{RBasis, AbstractVector, Any, NoCompress}"><code>ReducedBasis.extend</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">extend(basis::RBasis, new_snapshot, μ, ::NoCompress)</code></pre><p>Extend the reduced basis by one snapshot without any orthogonalization or compression procedure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/rbasis.jl#L137-L142">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.extend-Tuple{RBasis, AbstractVector, Any, QRCompress}" href="#ReducedBasis.extend-Tuple{RBasis, AbstractVector, Any, QRCompress}"><code>ReducedBasis.extend</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">extend(basis::RBasis, new_snapshot::AbstractVector, μ, qrcomp::QRCompress)</code></pre><p>Extend using QR orthonormalization and compression.</p><p>The orthonormalization is performed by QR decomposing the orthogonal projection <span>$\bm{\Psi}(\bm{\mu}_{n+1}) - B_n^\dagger [B_n^\dagger B_n]^{-1} B_n \bm{\Psi}(\bm{\mu}_n)$</span> and appending <span>$Q$</span> to snapshots. Modes that have an <span>$R$</span> column maximum falling below the <code>qrcomp.tol</code> tolerance are dropped.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/rbasis.jl#L152-L161">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.extend_overlaps-Tuple{Matrix, Vector, Vector}" href="#ReducedBasis.extend_overlaps-Tuple{Matrix, Vector, Vector}"><code>ReducedBasis.extend_overlaps</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">extend_overlaps(old_overlaps::Matrix, old_snapshots::Vector, new_snapshot::Vector)</code></pre><p>Extend an overlap matrix by one snapshot, where only the necessary dot products are computed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/rbasis.jl#L87-L92">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.in_bounds-Tuple{Any, RegularGrid}" href="#ReducedBasis.in_bounds-Tuple{Any, RegularGrid}"><code>ReducedBasis.in_bounds</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">in_bounds(μ, grid::RegularGrid)</code></pre><p>Check whether a given parameter point <code>μ</code> is in the convex hull of the grid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/grid.jl#L43-L47">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.interpolate-Tuple{RBasis, AffineDecomposition, Any, Any}" href="#ReducedBasis.interpolate-Tuple{RBasis, AffineDecomposition, Any, Any}"><code>ReducedBasis.interpolate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">interpolate(basis::RBasis, h::AffineDecomposition, μ, solver_online)</code></pre><p>Compute Hilbert-space-dimensional ground state vector at parameter point <code>μ</code> from the reduced basis using <span>$\bm{\Phi}(\bm{\mu}) = B \bm{\varphi}(\bm{\mu})$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/greedy.jl#L49-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.interpolate-Tuple{RBasis{ITensors.ITensorMPS.MPS}, AffineDecomposition, Any, Any}" href="#ReducedBasis.interpolate-Tuple{RBasis{ITensors.ITensorMPS.MPS}, AffineDecomposition, Any, Any}"><code>ReducedBasis.interpolate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">interpolate(basis::RBasis{MPS}, h::AffineDecomposition, μ, dm::DMRG, solver_online)</code></pre><p>Compute ground state MPS at <code>μ</code> from the reduced basis by MPS addition in <span>$| \Phi(\bm{\mu}) \rangle = \sum_{k=1}^{\dim B} [V \varphi(\bm{\mu_k})]_k\, | \Psi(\bm{\mu_k}) \rangle$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/mps.jl#L197-L202">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.mps_callback-Tuple{Any}" href="#ReducedBasis.mps_callback-Tuple{Any}"><code>ReducedBasis.mps_callback</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">mps_callback(info)</code></pre><p>Print maximal bond dimension, truncation error and other MPS diagnostics.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/mps.jl#L215-L219">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.multiplicity-Tuple{RBasis}" href="#ReducedBasis.multiplicity-Tuple{RBasis}"><code>ReducedBasis.multiplicity</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">multiplicity(basis::RBasis)</code></pre><p>Return the multiplicity of each truth solve.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/rbasis.jl#L46-L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.n_truthsolve-Tuple{RBasis}" href="#ReducedBasis.n_truthsolve-Tuple{RBasis}"><code>ReducedBasis.n_truthsolve</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">n_truthsolve(basis::RBasis)</code></pre><p>Return the number of truth solves (snapshots) contained in the basis.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/rbasis.jl#L39-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.overlap_matrix-Tuple{Any, Vector, Vector}" href="#ReducedBasis.overlap_matrix-Tuple{Any, Vector, Vector}"><code>ReducedBasis.overlap_matrix</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">overlap_matrix(v1::Vector, v2::Vector)
overlap_matrix(f, v1::Vector, v2::Vector)</code></pre><p>Compute the overlap matrix of two sets of vector-like objects <code>v1</code> and <code>v2</code>.</p><p>The computed matrix elements are the dot products <code>dot(v1[i], v2[j])</code>. Correspondingly, the elements of <code>v1</code> and <code>v2</code> must support a <code>LinearAlgebra.dot</code> method. In the case where <code>v1 = v2</code>, the Gram matrix is computed.</p><p>Optionally, a function <code>f</code> can be provided which is applied to each element of <code>v2</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/rbasis.jl#L55-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.print_callback-Tuple{Any}" href="#ReducedBasis.print_callback-Tuple{Any}"><code>ReducedBasis.print_callback</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">print_callback(info)</code></pre><p>Print diagnostic information at each assembly iteration.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/callback.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.random_guess-Tuple{Any, Any}" href="#ReducedBasis.random_guess-Tuple{Any, Any}"><code>ReducedBasis.random_guess</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">random_guess(info, offline_args)</code></pre><p>Provides a random initial guess according to the truth solver method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/greedy.jl#L77-L81">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.rb_guess-Tuple{Any, Any}" href="#ReducedBasis.rb_guess-Tuple{Any, Any}"><code>ReducedBasis.rb_guess</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rb_guess(info, offline_args; kwargs...)</code></pre><p>Provide the reduced basis interpolated ground state as an initial guess for the truth solver.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/greedy.jl#L62-L67">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.reconstruct-Tuple{ITensors.ITensorMPS.MPS}" href="#ReducedBasis.reconstruct-Tuple{ITensors.ITensorMPS.MPS}"><code>ReducedBasis.reconstruct</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">reconstruct(mps::MPS)</code></pre><p>Explicitly compute Hilbert-space-dimensional vector by reconstructing all MPS coefficients.</p><div class="admonition is-warning"><header class="admonition-header">Memory restrictions</header><div class="admonition-body"><p>The number of MPS coefficients grows exponentially with system size, such that the explicit reconstruction is only possible for small systems.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/mps.jl#L3-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.shift-Union{Tuple{N}, Tuple{D}, Tuple{RegularGrid{D, N}, Any}} where {D, N}" href="#ReducedBasis.shift-Union{Tuple{N}, Tuple{D}, Tuple{RegularGrid{D, N}, Any}} where {D, N}"><code>ReducedBasis.shift</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">shift(grid::RegularGrid{D,N}, μ_shift; stay_in_bounds=false) where {D,N}</code></pre><p>Shift a regular grid by a shift vector <code>μ_shift</code>. If <code>stay_in_bounds=true</code>, the shifted grid will stay in the convex hull of the unshifted grid. Note that the shift vector elements cannot be larger than the <code>grid.ranges</code> steps.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/grid.jl#L52-L58">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.solve-Tuple{AffineDecomposition, Any, Any, FullDiagonalization}" href="#ReducedBasis.solve-Tuple{AffineDecomposition, Any, Any, FullDiagonalization}"><code>ReducedBasis.solve</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">solve(H::AffineDecomposition, μ, Ψ₀, fd::FullDiagonalization)</code></pre><p>Solve Hamiltonian for lowest eigenvalues and eigenvectors at parameter point <code>μ</code> using  <a href="#ReducedBasis.FullDiagonalization"><code>FullDiagonalization</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/full_diag.jl#L24-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.solve-Tuple{AffineDecomposition, Any, Matrix, LOBPCG}" href="#ReducedBasis.solve-Tuple{AffineDecomposition, Any, Matrix, LOBPCG}"><code>ReducedBasis.solve</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">solve(H::AffineDecomposition, μ, Ψ₀::Matrix, lobpcg::LOBPCG)
solve(H::AffineDecomposition, μ, ::Nothing, lobpcg::LOBPCG)</code></pre><p>Solve using <a href="#ReducedBasis.LOBPCG"><code>LOBPCG</code></a>. If <code>nothing</code> is provided as an initial guess, an orthogonal random matrix will be used with <code>lobpcg.n_target + lobpcg.n_ep_extra</code> column vectors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/lobpcg.jl#L66-L73">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.solve-Tuple{AffineDecomposition, Any, Vector{ITensors.ITensorMPS.MPS}, DMRG}" href="#ReducedBasis.solve-Tuple{AffineDecomposition, Any, Vector{ITensors.ITensorMPS.MPS}, DMRG}"><code>ReducedBasis.solve</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">solve(H::AffineDecomposition, μ, Ψ₀::Vector{MPS}, dm::DMRG)
solve(H::AffineDecomposition, μ, Ψ₀::MPS, dm::DMRG)
solve(H::AffineDecomposition, μ, ::Nothing, dm::DMRG)</code></pre><p>Solve using <a href="#ReducedBasis.DMRG"><code>DMRG</code></a>.</p><p>The length of the <code>Ψ₀</code> vector determines the number of targeted states, given that <code>dm.n_states &gt; 1</code> and <code>dm.tol_degeneracy &gt; 0</code>. When <code>nothing</code> is provided as an initial guess, <code>dm.n_states</code> random MPS are used.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/mps.jl#L139-L149">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReducedBasis.solve-Tuple{AffineDecomposition, Matrix, Any, FullDiagonalization}" href="#ReducedBasis.solve-Tuple{AffineDecomposition, Matrix, Any, FullDiagonalization}"><code>ReducedBasis.solve</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">solve(h::AffineDecomposition, b::Matrix, μ, fd::FullDiagonalization)</code></pre><p>Solve the generalized eigenvalue problem <span>$h(\bm{\mu})\, \varphi(\bm{\mu}) = \lambda(\bm{\mu})\, b\, \varphi(\bm{\mu})$</span> at parameter point <code>μ</code> using <a href="#ReducedBasis.FullDiagonalization"><code>FullDiagonalization</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mfherbst/ReducedBasis.jl/blob/bc91deb75c5e9564234741747baa9213bc70d00c/src/full_diag.jl#L46-L52">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../examples/basis_analysis/">« Analyzing and modifying a reduced basis after assembly</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Friday 24 May 2024 09:21">Friday 24 May 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
